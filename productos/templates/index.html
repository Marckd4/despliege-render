{% extends 'base.html'%}

{% block content %}

<br>
<a href="{% url 'productos:formulario'%}" class="btn btn-dark btn-sm"> Nuevo Ingreso</a>
<a href="{% url 'productos:exportar_excel' %}" class="btn btn-dark btn-sm">üìä Exportar a Excel</a>
<a href="{% url 'resumen_view' %}" class="btn btn-dark btn-sm">üìä Resumen</a>



{% if user.is_authenticated %}
  <!-- <form method="post" action="{% url 'logout' %}" class="d-inline">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger btn-sm ">
      <i class="bi bi-box-arrow-right"></i> Cerrar sesi√≥n
    </button>
  </form> -->
{% endif %}



 <div class="mb-3">
    <label for="globalSearch" class="form-label"></label>
    <input type="search" id="globalSearch" class="form-control" placeholder="Buscar en la tabla...">
</div>

<div class="table-scroll">
   
    <table class="table table-striped table-hover mb-0">
        <thead class="table-dark">
            <tr>
                <th>Categoria</th>
                <th>Empresa</th>
                <th>Ubicacion</th>
                <th>Cod_Ean</th>
                <th>Cod_Dun</th>
                <th>Cod_Sistema</th>
                <th>Descripcion</th>
                <th>Unidad</th>
                <th>Pack</th>
                <th>FactorX</th>
                <th>Cajas</th>
                <th>Saldo</th>
                <th>Stock_Fisico</th>
                <th>Observacion</th>
                <th>Fecha_Venc</th>
                <th>Fecha_Imp</th>
                <th>Contenedor</th>
                <th>Fecha_Inv</th>
                <th>Encargado</th>
                <th>Acciones</th>
            </tr>
        </thead>
    
        <tboby>
        {% for producto in productos%}
        
        <tr>
            
            <td>{{ producto.categoria }}</td>
            <td>{{ producto.empresa }}</td>
            <td>{{ producto.ubicacion }}</td>
            <td>{{ producto.cod_ean }}</td>
            <td>
                <a href="{% url 'productos:detalle' producto.id%}">
                    
                    {{ producto.cod_dun }}
                </a>
            </td>
            <td>{{ producto.cod_sistema }}</td>
            <td>{{ producto.descripcion }}</td>
            <td>{{ producto.unidad }}</td>
            <td>{{ producto.pack }}</td>
            <td>{{ producto.factorx }}</td>
            <td>{{ producto.cajas }}</td>
            <td>{{ producto.saldo }}</td>
            <td>{{ producto.stock_fisico }}</td>
            <td>{{ producto.observacion }}</td>
            <td>{{ producto.fecha_venc }}</td>
            <td>{{ producto.fecha_imp }}</td>
            <td>{{ producto.contenedor }}</td>
            <td>{{ producto.fecha_inv }}</td>
            <td>{{ producto.encargado }}</td>
            
            <td>
                <a href="{% url 'productos:editar_producto' producto.id%}" class="btn btn-warning btn-sm">‚úèÔ∏è Editar</a>
                <a href="{% url 'productos:eliminar_producto' producto.id %}" class="btn btn-danger btn-sm"
                onclick="return confirm('¬øSeguro que deseas eliminar este registro?');">üóëÔ∏è Eliminar</a>

                
            </td>
        </tr>
        {% endfor %}
        </tboby>
    
    </table>
</div>
        <script>
        document.addEventListener('DOMContentLoaded', function(){
        const input = document.getElementById('globalSearch');
        if(!input) return;
        const table = document.querySelector('table');
        const tbody = table ? table.tBodies[0] : null;
        input.addEventListener('input', function(e){
            const q = e.target.value.trim().toLowerCase();
            if(!tbody){
            return;
            }
            Array.from(tbody.rows).forEach(row=>{
            const text = row.textContent.toLowerCase();
            const match = text.indexOf(q) !== -1;
            row.style.display = match ? '' : 'none';
            });
        });
        // Atajo: presionar '/' para enfocar la b√∫squeda (opcional)
        document.addEventListener('keydown', function(e){
            if(e.key === '/' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA'){
            e.preventDefault();
            input.focus();
            }
        });
        });
        </script>

        

{% endblock %}




